<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <META content="no-cache" http-equiv="pragma">
    <META content="-1" http-equiv="expires">
    <META content="text/html;charset=UTF-8" http-equiv="content-type">
    <LINK href="problem-statement.css" rel="stylesheet" type="text/css">
    <TITLE>트리 불 끄기</TITLE>
    <SCRIPT type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
        });
        </SCRIPT>
        <SCRIPT async="" src="https://polygon.codeforces.com/lib/MathJax/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
    </SCRIPT>
</HEAD><BODY>
    <DIV class="problem-statement"><DIV class="header"><DIV class="title">트리 불 끄기</DIV><DIV class="time-limit"><DIV class="property-title">time limit per test</DIV>2 seconds</DIV><DIV class="memory-limit"><DIV class="property-title">memory limit per test</DIV>512 megabytes</DIV><DIV class="input-file"><DIV class="property-title">input</DIV>standard input</DIV><DIV class="output-file"><DIV class="property-title">output</DIV>standard output</DIV></DIV><DIV class="legend"><P>$$$N$$$개의 정점으로 구성된 트리가 있다. 트리는 간선에 방향이 없는 연결된 그래프로, 각 정점에서 다른 정점으로 가는 최단 경로가 유일하다. 각 정점에는 전구와 스위치가 있는데, 각 전구는 켜져 있거나 꺼져 있다. 정점에 있는 스위치를 누르면, 그 정점의 전구의 상태가 바뀐다. 즉, 켜진 전구는 꺼지고, 꺼진 전구는 켜진다.</P><P>밥은 이 트리 위에 살고 있는 나무늘보이다. 밥은 처음에 $$$a$$$번 정점에 있는데, 다음의 절차를 $$$0$$$번 이상 수행해 트리의 전구를 모두 꺼진 상태로 만들고자 한다.</P><P></P><UL> <LI> 현재 밥이 $$$v$$$번 정점에 있다고 하자. $$$v$$$번 정점에 인접한 $$$u$$$번 정점을 선택한 뒤, $$$v$$$번 정점에 있는 스위치를 누르고 $$$u$$$번 정점으로 이동한다. </LI></UL><P></P><P>밥을 도와 위 절차를 $$$4N$$$번 이하로 수행해 트리의 전구를 모두 꺼진 상태로 만들 수 있는 방법을 찾아 주자. 문제의 조건 하에 그러한 방법이 언제나 존재함을 증명할 수 있다.</P></DIV><P></P><P></P><DIV class="input-specification"><DIV class="section-title">Input</DIV><P></P><P>첫 번째 줄에 정점의 개수 $$$N$$$과 밥이 처음에 위치한 정점의 번호 $$$a$$$가 공백으로 구분되어 주어진다. $$$(2 \le N \le 100\,000;$$$ $$$1 \le a \le N)$$$</P><P>두 번째 줄에 전구의 상태를 나타내는 길이 $$$n$$$의 문자열 $$$S$$$가 주어진다. $$$i$$$번 정점의 전구가 켜져 있는 상태라면 $$$i$$$번째 문자는 <SPAN class="tex-font-style-tt">'1'</SPAN>, 그렇지 않다면 $$$i$$$번째 문자는 <SPAN class="tex-font-style-tt">'0'</SPAN>이다.</P><P>세 번째 줄부터 $$$N-1$$$개의 줄에 걸쳐 각각의 간선이 연결하는 두 정점의 번호 $$$x_i$$$, $$$y_i$$$가 공백으로 구분되어 주어진다. $$$(1 \le x_i &lt; y_i \le N)$$$</P><P>주어진 그래프는 올바른 트리임이 보장된다.</P></DIV><P></P><P></P><DIV class="output-specification"><DIV class="section-title">Output</DIV><P></P><P>첫 번째 줄에 밥이 트리의 전구를 모두 꺼진 상태로 만들기 위해 사용할 절차의 횟수 $$$k$$$를 출력한다. $$$(0 \le k \le 4N)$$$</P><P>두 번째 줄에 각 절차에서 선택한 정점을 나타내는 $$$k$$$개의 정수 $$$u_1,u_2,\cdots,u_k$$$를 공백으로 분리하여 출력한다. 이때 $$$u_1$$$번 정점은 $$$a$$$번 정점에 인접해야 하며, $$$2 \le i \le k$$$인 모든 $$$i$$$에 대해 $$$u_i$$$번 정점은 $$$u_{i-1}$$$번 정점에 인접해야 한다.</P><P>조건에 따라 트리의 전구을 모두 꺼진 상태로 만드는 방법이 여러 가지라면 그 중 하나만 출력한다. 또한, 수행하는 절차의 수가 최소가 될 필요는 없다.</P></DIV><P></P><P></P><DIV class="sample-tests"><DIV class="section-title">Example</DIV><P></P><P></P><DIV class="sample-test"><DIV class="input"><DIV class="title">Input</DIV><PRE class="content">
<DIV class="test-example-line test-example-line-even test-example-line-0">6 4</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">101101</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 2</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">2 3</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">3 4</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">3 5</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">3 6</DIV></PRE></DIV><DIV class="output"><DIV class="title">Output</DIV><PRE class="content">
12
3 2 1 2 3 5 3 5 3 6 3 4
</PRE></DIV></DIV></DIV><P></P><P></P><DIV class="note"><DIV class="section-title">Note</DIV><P></P><P>예제에서 밥이 따르는 절차와 그에 따른 전구의 상태는 아래와 같다.</P><P></P><OL> <LI> 밥이 $$$u=3$$$번 정점으로 이동하고, $$$v=4$$$번 정점의 전구가 꺼진다. </LI><LI> 밥이 $$$u=2$$$번 정점으로 이동하고, $$$v=3$$$번 정점의 전구가 꺼진다. </LI><LI> 밥이 $$$u=1$$$번 정점으로 이동하고, $$$v=2$$$번 정점의 전구가 켜진다. </LI><LI> 밥이 $$$u=2$$$번 정점으로 이동하고, $$$v=1$$$번 정점의 전구가 꺼진다. </LI><LI> 밥이 $$$u=3$$$번 정점으로 이동하고, $$$v=2$$$번 정점의 전구가 꺼진다. </LI><LI> 밥이 $$$u=5$$$번 정점으로 이동하고, $$$v=3$$$번 정점의 전구가 켜진다. </LI><LI> 밥이 $$$u=3$$$번 정점으로 이동하고, $$$v=5$$$번 정점의 전구가 켜진다. </LI><LI> 밥이 $$$u=5$$$번 정점으로 이동하고, $$$v=3$$$번 정점의 전구가 꺼진다. </LI><LI> 밥이 $$$u=3$$$번 정점으로 이동하고, $$$v=5$$$번 정점의 전구가 꺼진다. </LI><LI> 밥이 $$$u=6$$$번 정점으로 이동하고, $$$v=3$$$번 정점의 전구가 켜진다. </LI><LI> 밥이 $$$u=3$$$번 정점으로 이동하고, $$$v=6$$$번 정점의 전구가 꺼진다. </LI><LI> 밥이 $$$u=4$$$번 정점으로 이동하고, $$$v=3$$$번 정점의 전구가 꺼진다. </LI></OL><P></P><P>총 $$$12$$$번의 절차를 시행하였으며, 절차가 끝난 후 트리의 전구는 모두 꺼진 상태이다.</P></DIV></DIV><P></P><P>  </P>

</BODY></HTML>
